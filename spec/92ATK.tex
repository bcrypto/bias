\begin{appendix}{Б}{справочное}{Атаки}\label{ATK}

\hiddensection{Атаки при регистрации и подтверждении личности}\label{ATK.UR}

{\bf Выдача себя за другого}. 
Противник регистрируется, выдавая себя за другого пользователя.
Например, противник проходит регистрацию, предъявляя чужое удостоверение.  

%Для защиты от атаки следует использовать надежное 
%удостоверение или даже несколько разнотипных удостоверений.

{\bf Отказ от регистрации}. 
Противник отказывается от факта регистрации в инфраструктуре.
Например, противник утверждает, что кто-то выдал себя за него,
предъявив поддельное удостоверение.

%Для защиты от атаки пользователя следует обязать регистрироваться
%лично и письменно подтвердить факт регистрации. Например,
%пользователь должен подать заявление о регистрации и 
%подписать его собственноручно.

{\bf Раскрытие секрета}. 
Секрет аутентификации, который СИ передает пользователю в момент 
регистрации, перехватывает противник. Например, противник перехватывает  
QR-код секретного ключа генерации одноразовых паролей.

%Для защиты от атаки при личной регистрации секрет следует передавать в 
%физически защищенной форме, например, в запечатанном конверте. 
%При удаленной регистрации следует защищать соединение между КП пользователя 
%и СИ.  

{\bf Модификация секрета}. 
Секрет аутентификации, который пользователь передает СИ в момент 
регистрации, модифицирует противник.  
Например, противник меняет пароль, который выбирает пользователь при 
регистрации на сайте СИ. 

%Для защиты от атаки при личной регистрации секрет
%следует передавать в физически защищенной форме. 
%При удаленной регистрации следует защищать соединение между КП 
%пользователя и СИ. Кроме этого, при удаленной регистрации пользователю 
%следует аутентифицировать СИ. 

{\bf Неавторизованный выпуск}. 
Противник навязывает СИ выпуск аттестата, 
предназначенного другому пользователю, но связанному с токеном противника.
%
Например, противник получает сертификат открытого ключа 
для своего личного ключа, но на чужое доменное имя. 

%Для защиты от атаки СИ следует привлекать к выпуску токенов и аттестатов
%нескольких независимых сотрудников.  
%%
%СИ следует убедиться в том, что токен действительно передается тому 
%пользователю, который прошел регистрацию. 

\hiddensection{Атаки на токены}\label{ATK.TI}

{\bf Кража}. 
Противник совершает кражу физического токена. Объектом кражи может быть
аппаратный КТ, OTP-токен, карта кодов, сетевой токен (сотовый телефон).

%Для защиты от атаки следует использовать многофакторные токены,
%требующие ввода PIN-кода или биометрических данных для активации.
%Пользователей следует инструктировать о том, как действовать 
%в случае пропажи или кражи токена. СИ следует предусмотреть 
%отзыв токена после уведомления его владельца.

%{\bf Разведка}. 
%Противник восстанавливает зарегистрированные пользователем факты, 
%выполняя разведочный анализ различных источников данных.
%%
%Например, противник узнает ответы на общие вопросы 
%(номер школы, которую Вы закончили?)
%в социальных сетях.
%
%Для защиты от атаки следует использовать факты,
%которые трудно определить в результате разведки.

{\bf Дублирование}. 
Противник дублирует токен без ведома владельца.
%
Например, переписывает пароль, записанный на бумаге,
копирует файлы программного КТ, фотографирует карту кодов.

%Для защиты от атаки следует использовать аппаратные токены,
%которые трудно клонировать.

{\bf Перехват}. 
Противник перехватывает аутентификаторы
в момент их ввода пользователем и определяет по ним будущие аутентификаторы.
%
Например, противник наблюдает за клавиатурой визуально или использует 
вредоносные программы, которые фиксируют клавиатурные события 
операционной системы. 

%Для защиты от атаки следует так проектировать токены,
%что по перехваченным аутентификаторам трудно определить следующие за ними. 
%При генерации аутентификаторов следует использовать запросы от СИ.
%Следует предусмотреть защиту от вредоносных программ и устройств в среде
%эксплуатации КП.

{\bf Взлом}. 
Противник восстанавливает секрет аутентификации по токену или 
аутентификаторам, используя аналитические методы.
%
Например, противник определяет секрет программного КТ,
проводя словарную атаку на пароль защиты файла с секретом,
или находит личный ключ аппаратного КТ, анализируя флуктуации времени 
выполнения криптографических операций. 

%Для защиты от атаки следует использовать высокоэнтропийные секреты 
%аутентификации. Аппаратный токен следует блокировать после нескольких
%неудачных попыток активации. Следует обеспечить физическую защиту 
%аппаратных токенов.

{\bf Фишинг~/ фарминг}. 
Противник узнает аутентификаторы, выдавая себя за СИ, и определяет будущие 
аутентификаторы.
%
Например, противник переадресует пользователя на поддельную страницу 
аутентификации.

%Для защиты от фишинга и фарминга следует так проектировать токены,
%что по известным аутентификаторам трудно определить следующие за ними. 
%Следует предусмотреть инструктирование пользователей.

{\bf Социальная инженерия}. 
Противник входит в доверие к пользователю и узнает его секрет аутентификации.
%
Например, противник звонит по телефону, представляется системным администратором 
и просит сообщить пароль.

%Для защиты от атаки следует предусмотреть инструктирование пользователей.

{\bf Угадывание}. 
Противник угадывает аутентификатор в ходе выполнения протокола аутентификации.
%
Например, противник угадывает статический пароль (предъявляя наиболее
вероятные варианты) или угадывает одноразовый пароль, пробуя случайные
варианты в комбинации с известными логинами.

%Для защиты от атаки следует использовать высокоэнтропийные аутентификаторы.
%При использовании текстовых паролей следует организовать контроль их 
%качества (через контроль длины и алфавита паролей, 
%через запрет популярных паролей).

% todo: Атаки перехват, фишинг/фарминг, угадывание перенести в ATK.AP?

\hiddensection{Атаки на протоколы аутентификации}\label{ATK.AP}

{\bf Подбор аутентификатора}. 
Противник в последовательных сеансах аутентификации пытается 
угадать аутентификатор, проверяя различные его варианты. 
Например, аутентификатором является статический пароль, 
и противник проверяет часто используемые пароли. 
Противник может использовать словарь таких паролей (словарные атаки).

%Для защиты от атаки следует использовать высокоэнтропийные 
%аутентификаторы. Следует предусмотреть меры контроля числа попыток 
%аутентификации.

{\bf Фишинг}. 
Противник вынуждает пользователя раскрыть секрет аутентификации, 
идентификационные данные и др. Используя раскрытые данные, противник 
выдает себя за пользователя перед СИ. Например, пользователь  
получает электронное письмо с приглашением пройти аутентификацию на 
СИ, контролируемом противником, и в ходе аутентификации раскрывает 
свой статический пароль. 

{\bf Фарминг}. 
Противник перенаправляет пользователя на поддельный СИ,
манипулируя таблицами сетевых адресов.
Пользователь проходит аутентификацию, не подозревая,
с кем он взаимодействует.

%Для защиты от фишинга и фарминга пользователю следует проводить
%встречную аутентификацию СИ.

{\bf Перехват}. 
Противник перехватывает сообщения протокола и обрабатывает их,
надеясь получить информацию, которая позволит выдать себя за пользователя. 
Например, противник перехватывает хэш-значение статического пароля.
Обработка состоит в переборе подходящих паролей, их хэшировании и 
сравнении результатов с данными перехвата. 

%Для защиты от атаки следует передавать критические сообщения протокола 
%по защищенному соединению.

{\bf Раскрытие}. 
Противник перехватывает сообщения протокола и 
определяет приватные идентификационные данные или даже просто 
идентификатор пользователя, который выполняет протокол аутентификации.
% 
Например, используется клиентская аутентификация TLS, 
и пользователь передает СИ в открытом виде
свой сертификат с персональными данными.

%Для защиты от атаки следует запретить передачу каких-либо 
%идентификационных данных пользователя в открытом виде.
%Эти данные могут защифровываться на общих сеансовых
%ключах или на открытом ключе СИ.

{\bf Повтор}. 
Противник повторяет определенные сообщения предыдущего сеанса протокола,
пытаясь выдать себя за пользователя в текущем сеансе. 
%
Например, противник предъявляет хэш-значение статического пароля,
перехваченное в предыдущем сеансе.

%Для защиты от атаки в протоколе следует использовать
%уникальные синхропосылки (нонсы). Эти синхропосылки делают
%сеансы протокола разными и не позволяют предъявить данные одного 
%сеанса в другом.

{\bf Противник посередине}. 
Противник встраивается во взаимодействие между пользователем и СИ во время
выполнения протокола аутентификации. Противник выдает себя 
за пользователя перед СИ и (или) за СИ перед пользователем. 
Например, противник открывает поддельный СИ, которому пользователь 
пересылает свой одноразовый пароль. Противник сразу же отсылает
этот пароль на настоящий СИ, выдавая себя за пользователя.

%Для защиты от атаки пользователю следует предварительно проводить встречную 
%аутентификацию СИ.  
%%
%Защита от атаки может быть слабой и сильной. 
%При слабой защите пользователь может продолжить протокол, даже 
%если аутентификация СИ завершена с ошибкой. Например, пользователь 
%получает предупреждение <<Сертификат СИ просрочен>>, но все равно имеет 
%возможность нажать кнопку <<Продолжить>>.
%При сильной защите продолжение невозможно.

{\bf Вредоносные программы}. 
Противник встраивает в среду эксплуатации КП вредоносное 
программное обеспечение, с помощью которого контролирует
ход протокола или компрометирует ТА.

%Для защиты от атаки следует использовать аппаратные ТА,
%которые реализуют операции с критическими объектами
%внутри аппаратно-защищенной криптографической границы.
%Эту границу не могут преодолеть вредоносные программы.

{\bf Снижение уровня}. 
Противник навязывает выполнение менее стойкого протокола
или протокола с ослабленными параметрами.

%Для защиты от атаки следует контролировать тип протокола
%и его настройки, в том числе используемые ТА. Информацию 
%о выполненном протоколе следует указывать в БА. 
%%
%Не следует применять протоколы, стойкость которых существенно 
%снижается при определенных настройках.
%%
%ПС следует предоставить возможность задания перечня подходящих
%протоколов в запросе аутентификации. В выборе и настройке 
%протокола из перечня следует задействовать пользователя. 

\hiddensection{Атаки на аттестаты}\label{ATK.CM}

{\bf Раскрытие секретов при хранении}.
Противник получает доступ к базе данных СИ, в которой хранятся 
секретные аттестаты, и раскрывает секреты аутентификации. 
%
Например, противник получает файл пар (логин, пароль) и узнает пароли 
пользователей. 

%Для защиты от атаки СИ следует наладить контроль доступа к базам данных с 
%аттестатами, запретив неавторизованное чтение. 

{\bf Модификация аттестатов при хранении}.
Противник получает доступ к базе данных СИ, в которой хранятся аттестаты,
и изменяет их. 
%
Например, противник меняет соответствие в парах (логин, пароль)
или устанавливает свои пароли.

%Для защиты от атаки СИ следует наладить контроль доступа к базам данных с 
%секретами, запретив неавторизованное изменение. 

{\bf Раскрытие секрета при перевыпуске}. 
Секрет аутентификации, который СИ передает пользователю при перевыпуске
аттестата, перехватывает противник.

%Для защиты от атаки следует защищать соединение между КП пользователя и СИ. 

{\bf Модификация секрета при перевыпуске}. 
Секрет аутентификации, который пользователь передает СИ при перевыпуске, 
меняет противник.  

%Для защиты от атаки следует защищать соединение между КП пользователя и СИ. 
%Кроме этого, пользователю следует аутентифицировать СИ и проверять, 
%что СИ наделена полномочиями перевыпуска.  

{\bf Неавторизованный перевыпуск}. 
Противник навязывает СИ перевыпуск аттестата
другого пользователя, связывая аттестат со своим токеном.
Противник перевыпускает аттестат, предъявляя просроченный 
или отозванный токен.

%Для защиты от атаки СИ следует организовать во время перевыпуска
%и регистрации новых токенов проверку владения старыми.  
%%
%СИ следует запрещать перевыпуск при предъявлении просроченных или 
%отозванных токенов. 

{\bf Использование отозванных токенов}. 
Противник проходит аутентификацию с помощью уже отозванного токена,
используя задержку в оповещении об отзыве или отсутствие оповещения.
%
Например, оповещение реализуется еженедельной публикацией списка 
отозванных сертификатов. Противник пользуется отозванным токеном вплоть до 
публикации. 

%Для защиты от атаки СИ следует оповещать об отзыве токенов как можно быстрее.
%СИ следует запрещать использование отозванных аттестатов.

{\bf Использование просроченных токенов}. 
Противник использует аппаратный токен по истечении срока его действия.
Например, противник определяет конфиденциальное содержимое предыдущих 
сеансов связи, организованных с помощью токена.

%Для защиты от атаки СИ следует предусмотреть вывода просроченных токенов 
%из обращения. Вывод из обращения должен включать очистку критических 
%областей памяти.

\hiddensection{Атаки на билеты и сеансы}\label{ATK.TM}

{\bf Подделка БА}.
Противник выпускает поддельный БА или модифицирует уже выпущенный.
%
Например, противник продлевает срок действия БА.
%
Поддельный билет открывает несанкционированный доступ к ресурсам ПС.

%Для защиты от атаки СИ следует подписывать БА, а ПС проверять подпись.
%Или СИ следует передавать билет по защищенному соединению.

{\bf Раскрытие утверждений}.
Противник раскрывает приватные утверждения о пользователе,
которые содержатся в БА или в ответах на БД.

%Для защиты от атаки СИ и СР следует конвертовать утверждения для ПС.
%Или СИ и СР следует передавать утверждения по защищенному соединению.

{\bf Оспаривание выпуска БА}.
СИ отказывается от факта выпуска БА,
утверждая, что билет выпущен другой стороной.

%Для защиты от атаки СИ следует подписывать БА. Корректная ЭЦП билета может 
%быть построена только владельцем личного ключа, т.~е. СИ. 

{\bf Оспаривание предъявления БА}.
Пользователь отказывается от факта предъявления БА
и, как следствие, от факта выполнения операций с ПС.
Пользователь утверждает, что билет предъявила другая сторона.

%Для защиты от атаки следует давать в БА ссылку на секрет пользователя, 
%а пользователю следует подтверждать владение этим секретом. Например, 
%пользователь может подписать на своем личном ключе сообщение, описывающее 
%операцию. Если пользователь не располагает средством ЭЦП, 
%то следует реализовать другой протокол подтверждения операций.
%В этом протоколе могут быть задействованы токены аутентификации
%пользователя.

{\bf Перенаправление БА}.
Противник использует БА, выпущенный для одной ПС,
для получения доступа к ресурсам другой ПС. 

%Для защиты от атаки следует включать в БА идентификационные данные ПС.
%При получении билета ПС следует проверять наличие этих данных.

{\bf Повторное использование БА}.
Противник использует БА, который уже ранее 
использовался законным пользователем билета.

%Для защиты от атаки следует включать в БА время выпуска и срок действия. 
%ПС следует проверять, что присланный билет не просрочен.
%ПС следует вести контроль билетов, поступивших за определенное время.
%Контроль должен блокировать повторное использование БА.

{\bf Подделка аутентификатора}.
Противник выпускает вторичный аутентификатор другого 
пользователя, и этот аутентификатор принимается другими сторонами. 

%Вторичный аутентификатор следует строить так, чтобы он был высокоэнтропийным. 
%Следует ограничивать срок действия аутентификатора и число его предъявлений.

{\bf Перехват аутентификатора}.
Противник перехватывает вторичный аутентификатор другого пользователя.
Перехват выполняется во время передачи аутентификатора от СИ к КП или 
от КП к ПС. Противник проводит атаки <<кража сеанса>>, <<противник посередине>>
и др. 

%Для защиты от атаки вторичный аутентификатор следует передавать по 
%защищенным соединениям. Речь идет о соединениях СИ~--- КП, КП~--- ПС, 
%ПС~--- СИ, ПС~--- CР. Даже если аутентификатор является одноразовым и уже 
%использован, его не следует передавать по открытым соединениям вплоть до 
%окончания срока действия.

{\bf Подмена ответов}.
Противник вмешивается в передачу данных между ПС и другими сторонами 
и в ответ на вторичный аутентификатор одного пользователя
возвращает утверждения или билеты другого.
%
Например, противник меняет порядок запросов и ответов.

%В ответы следует включать ссылки на запросы (например, хэш-значения 
%запросов) и эти ответы следует подписывать. Или ответы и запросы 
%следует пересылать по защищенным соединениям.

{\bf Кража сеанса}. 
Противник встраивается во взаимодействие между пользователем 
и сервером (СИ или ПС) сразу после успешного завершения протокола 
аутентификации. Противник выдает себя за пользователя перед сервером 
или наоборот. 
%
Например, противник перехватывает БС (куки) или угадывает его. 

%Для предотвращения кражи сеанса следует использовать надежные БС
%и удалять их после использования. Следует передавать БС по защищенному
%соединению. Серверу следует контролировать продолжительность сеанса 
%и закрывать неактивные сеансы. 

\begin{note*}
Кража сеанса возможна даже при использовании защищенных TLS-соединений. 
Кража может быть организована с помощью атаки CSRF (Cross Site Request 
Forgery, межсайтовая подделка запроса). В атаке CSRF сервер противника 
содержит ссылку на узел ПС. Пользователь автоматически перенаправляется 
на этот узел при каждом заходе на сервер противника. 
Если в момент перенаправления пользователь прошел аутентификацию
перед СИ по запросу ПС и информация об этом сохранилась в куки его браузера,
то этот куки может быть автоматически предъявлен ПС.
%
ПС может оказать пользователю цифровые услуги даже без его ведома.
%
%Для защиты от атаки CSRF следует связывать запрос
%аутентификации~ПС с запросом пользователя к ПС.
\end{note*}

\end{appendix}